---
title: Project title
author: by Ella and Leo
output: github_document
---

```{r load-packages, message = FALSE}
library(tidyverse)
library(broom)
library(readr)
```

```{r Alc_Race_data_frame}
Alc_Race_data_frame <- new_youth_risk_df %>%
  filter(ShortQuestionText %in% c("Initiation of alcohol use", "Ever alcohol use", "Current alcohol use", "Largest number of drinks")) %>%
  group_by(ShortQuestionText, Race) %>%
  summarise(Greater_Risk_Data_Value = round(mean(Greater_Risk_Data_Value, na.rm =TRUE), digits = 0), Sample_Size = Sample_Size, Sex, Grade, SexualIdentity, SexOfSexualContacts)%>%
   arrange(desc(Greater_Risk_Data_Value)) %>%
  filter(Sex == "Total", Grade == "Total", SexualIdentity == "Total", SexOfSexualContacts == "Total")


 Alc_Race_data_frame <- Alc_Race_data_frame %>%
 pivot_longer(
    ends_with("Risk_Data_Value"), 
    names_to = "Risk_Data", 
    values_to = "Risk_Percent")  
```

```{r Alc-Race-sample-size-segmented-bar-graph}
Alc_Race_data_frame$Race <-  fct_relevel(Alc_Race_data_frame$Race, c("Native Hawaiian or Other Pacific Islander", "Black or African American", "Asian","American Indian or Alaska Native", "Multiple Race", "Hispanic or Latino", "White", "Total"))

Alc_Race_data_frame %>% 
ggplot(aes(y= Race, x = Sample_Size, fill = ShortQuestionText)) +
   geom_col(position="stack", stat="identity") +
labs(y = "Race", x = "Sample Size",
    title = "Risky behaviors in teen alcohol use",
    subtitle = "By Sample size of Race",
    fill = "Severity") +
  scale_fill_viridis_d(name="Questions",
                     breaks=c("Largest number of drinks", "Initiation of alcohol use", "Ever alcohol use", "Current alcohol use"),
                     labels = c("Students who reported that the largest \nnumber of drinks they had in a row was 10 or more", "Students who had their first drink of \nalcohol before age 13 years", "Students who ever drank alcohol", "Students who currently drink alcohol"))
```

```{r Alc-Race-segmented-bar-graph, fig.alt = "Bar chart of Risky behaviors in teen alcohol use by Race and Percentage engaging in risky behavoirs. The questions being asked are students who reported that the largest number of drinks they had in a row was 10 or more, students who had their first drink of alcohol before age 13 years, students who ever drank alcohol, students who currently drink alcohol, and the races counted are Black or African American, Asian, American Indian or Alaska Native, Multiple Race, Hispanic or Latino, White, and Total of all races."}
Alc_Race_data_frame$Race <-  fct_relevel(Alc_Race_data_frame$Race, c("Black or African American", "Asian", "American Indian or Alaska Native", "Multiple Race", "Hispanic or Latino", "White", "Total"))

Alc_Race_data_frame %>% 
  filter(Race != "Native Hawaiian or Other Pacific Islander") %>%
ggplot(aes(y= Race, x = Risk_Percent, fill = ShortQuestionText)) +
   geom_col(position="dodge", stat="identity") +
labs(y = "Race", x = "Percentage",
    title = "Risky behaviors in teen alcohol use",
    subtitle = "By Race",
    fill = "Severity") +
  scale_fill_viridis_d(name="Questions",
                     breaks=c("Largest number of drinks", "Initiation of alcohol use", "Ever alcohol use", "Current alcohol use"),
                     labels = c("Students who reported that the largest \nnumber of drinks they had in a row was 10 or more", "Students who had their first drink of \nalcohol before age 13 years", "Students who ever drank alcohol", "Students who currently drink alcohol"))
```

```{r Alc_Grade_data_frame}
Alc_Grade_data_frame <- new_youth_risk_df %>%
  filter(ShortQuestionText %in% c("Initiation of alcohol use", "Ever alcohol use", "Current alcohol use", "Largest number of drinks")) %>%
  group_by(ShortQuestionText, Grade) %>%
  summarise(Greater_Risk_Data_Value = round(mean(Greater_Risk_Data_Value, na.rm =TRUE), digits = 0), Sample_Size = Sample_Size, Sex, Race, SexualIdentity, SexOfSexualContacts) %>%
    filter(Sex == "Total", Race == "Total", SexualIdentity == "Total", SexOfSexualContacts == "Total")

 Alc_Grade_data_frame <- Alc_Grade_data_frame %>%
 pivot_longer(
    ends_with("Risk_Data_Value"), 
    names_to = "Risk_Data", 
    values_to = "Risk_Percent") 
    # filter(Grade != "Total", Sex != "Total")
```
```{r Alc-Grade-sample-size-segmented-bar-graph}
Alc_Grade_data_frame$Grade <-  fct_relevel(Alc_Grade_data_frame$Grade,  c("9th", "10th", "11th", "12th", "Total"))

Alc_Grade_data_frame %>% 
ggplot(aes(y= Grade, x = Sample_Size, fill = ShortQuestionText)) +
   geom_col(position= "stack", stat= "identity") +
labs(y = "Grade", x = "Sample Size",
    title = "Risky behaviors in teen alcohol use",
    subtitle = "By Sample size of Grade",
    fill = "Severity") +
  scale_fill_viridis_d(name="Questions",
                     breaks=c("Largest number of drinks", "Initiation of alcohol use", "Ever alcohol use", "Current alcohol use"),
                     labels = c("Students who reported that the largest \nnumber of drinks they had in a row was 10 or more", "Students who had their first drink of \nalcohol before age 13 years", "Students who ever drank alcohol", "Students who currently drink alcohol"))
```

```{r Alc_Grade-segmented-bar-graph}
Alc_Grade_data_frame$Grade <-  fct_relevel(Alc_Grade_data_frame$Grade, c("9th", "10th", "11th", "12th", "Total"))

Alc_Grade_data_frame %>% 
  filter(Grade != "Native Hawaiian or Other Pacific Islander") %>% 
ggplot(aes(y= Grade, x = Risk_Percent, fill = ShortQuestionText)) +
   geom_col(position="dodge", stat="identity") +
 labs(y = "Grade", x = "Percentage",
    title = "Risky behaviors in teen alcohol use",
    subtitle = "By Grade",
    fill = "Severity") +
  scale_fill_viridis_d(name="Questions",
                     breaks=c("Largest number of drinks", "Initiation of alcohol use", "Ever alcohol use", "Current alcohol use"),
                     labels = c("Students who reported that the largest \nnumber of drinks they had in a row was 10 or more", "Students who had their first drink of \nalcohol before age 13 years", "Students who ever drank alcohol", "Students who currently drink alcohol"))
```
```{r Sex_Race_data_frame}
Alc_Sex_data_frame <- new_youth_risk_df %>%
  filter(ShortQuestionText %in% c("Initiation of alcohol use", "Ever alcohol use", "Current alcohol use", "Largest number of drinks")) %>%
  group_by(ShortQuestionText, Sex) %>%
  summarise(Greater_Risk_Data_Value = round(mean(Greater_Risk_Data_Value, na.rm =TRUE), digits = 0), Sample_Size = Sample_Size, Grade, Race, SexualIdentity, SexOfSexualContacts) %>%
    filter(Grade == "Total", Race == "Total", SexualIdentity == "Total", SexOfSexualContacts == "Total")

 Alc_Sex_data_frame <- Alc_Sex_data_frame %>%
 pivot_longer(
    ends_with("Risk_Data_Value"), 
    names_to = "Risk_Data", 
    values_to = "Risk_Percent") 
    # filter(Grade != "Total", Sex != "Total")
```
```{r Alc-Sex-sample-size-segmented-bar-graph}
Alc_Sex_data_frame$Sex <-  fct_relevel(Alc_Sex_data_frame$Sex, c("Female","Male", "Total"))

Alc_Sex_data_frame %>% 
ggplot(aes(y= Sex, x = Sample_Size, fill = ShortQuestionText)) +
   geom_col(position= "stack", stat= "identity") +
labs(y = "Sex", x = "Sample Size",
    title = "Risky behaviors in teen alcohol use",
    subtitle = "By Sample size of Grade",
    fill = "Severity") +
  scale_fill_viridis_d(name="Questions",
                     breaks=c("Largest number of drinks", "Initiation of alcohol use", "Ever alcohol use", "Current alcohol use"),
                     labels = c("Students who reported that the largest \nnumber of drinks they had in a row was 10 or more", "Students who had their first drink of \nalcohol before age 13 years", "Students who ever drank alcohol", "Students who currently drink alcohol"))
```

```{r Alc_Sex-segmented-bar-graph}
Alc_Sex_data_frame %>% 
  filter(Sex != "Native Hawaiian or Other Pacific Islander") %>% 
ggplot(aes(y= Sex, x = Risk_Percent, fill = ShortQuestionText)) +
   geom_col(position="dodge", stat="identity") +
 labs(y = "Sex", x = "Percentage",
    title = "Risky behaviors in teen alcohol use",
    subtitle = "By Sex",
    fill = "Severity") +
  scale_fill_viridis_d(name="Questions",
                     breaks=c("Largest number of drinks", "Initiation of alcohol use", "Ever alcohol use", "Current alcohol use"),
                     labels = c("Students who reported that the largest \nnumber of drinks they had in a row was 10 or more", "Students who had their first drink of \nalcohol before age 13 years", "Students who ever drank alcohol", "Students who currently drink alcohol"))
```

```{r old-atempts}
# Alc_data_frame %>% 
#   ggplot(aes(x= ShortQuestionText, y = Risk_Percent, fill = Race))+
#   geom_col(position = "dodge") +
#   facet_wrap(~Risk_Data) +
#   scale_fill_brewer(palette = "RdPu")
```

